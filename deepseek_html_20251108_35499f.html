<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…‰å½±é­”æ³•å®éªŒå®¤</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a2a6c, #2a3a7c);
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
            width: 100%;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
            background: linear-gradient(90deg, #ff8a00, #e52e71);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 15px;
        }
        
        .lab-container {
            position: relative;
            width: 95%;
            max-width: 800px;
            height: 400px;
            background: 
                radial-gradient(circle at 20% 30%, rgba(40, 60, 130, 0.7) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(30, 50, 120, 0.7) 0%, transparent 50%),
                #0f1a5a;
            border: 2px solid #3949ab;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            margin: 0 auto 20px;
            overflow: hidden;
        }
        
        .light-source {
            position: absolute;
            width: 80px;
            height: 40px;
            cursor: move;
            z-index: 10;
            left: 80px;
            top: 180px;
        }
        
        .flashlight-body {
            width: 30px;
            height: 40px;
            background: linear-gradient(to right, #5a5a5a, #2c2c2c, #5a5a5a);
            border-radius: 5px;
            position: absolute;
            left: 0;
            top: 0;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.7);
        }
        
        .flashlight-head {
            width: 50px;
            height: 40px;
            background: linear-gradient(to right, #8a8a8a, #a0a0a0, #8a8a8a);
            border-radius: 10px 20px 20px 10px;
            position: absolute;
            left: 25px;
            top: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.7);
        }
        
        .flashlight-lens {
            width: 30px;
            height: 30px;
            background: radial-gradient(circle, rgba(255,255,255,0.9) 0%, rgba(200,230,255,0.7) 30%, rgba(100,180,255,0.3) 70%, transparent 100%);
            border-radius: 50%;
        }
        
        .light-beam {
            position: absolute;
            width: 400px;
            height: 200px;
            background: conic-gradient(from 90deg at 0% 50%, 
                rgba(255,255,150,0.8) 0deg, 
                rgba(255,255,100,0.6) 30deg, 
                rgba(255,200,50,0.4) 60deg, 
                transparent 90deg);
            clip-path: polygon(0% 50%, 100% 0%, 100% 100%);
            left: 75px;
            top: -80px;
            z-index: 5;
            opacity: 0.7;
            pointer-events: none;
        }
        
        .object {
            position: absolute;
            width: 70px;
            height: 70px;
            background: radial-gradient(circle at 30% 30%, #e91e63, #c2185b);
            border-radius: 50%;
            cursor: move;
            z-index: 20;
            left: 300px;
            top: 165px;
            box-shadow: 
                inset -5px -5px 10px rgba(0, 0, 0, 0.3),
                0 5px 15px rgba(0, 0, 0, 0.4);
        }
        
        .object-highlight {
            position: absolute;
            width: 20px;
            height: 20px;
            background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, transparent 70%);
            border-radius: 50%;
            top: 15px;
            left: 15px;
        }
        
        .screen {
            position: absolute;
            width: 20px;
            height: 250px;
            background: linear-gradient(to right, #cfd8dc, #eceff1, #cfd8dc);
            right: 80px;
            top: 75px;
            z-index: 5;
            cursor: move;
            border-radius: 3px;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
        }
        
        .shadow {
            position: absolute;
            background: radial-gradient(ellipse, rgba(0, 0, 0, 0.7) 0%, rgba(0, 0, 0, 0.3) 70%, transparent 100%);
            border-radius: 50%;
            pointer-events: none;
            z-index: 15;
            opacity: 0.8;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
            width: 95%;
            max-width: 800px;
        }
        
        button {
            padding: 12px 20px;
            background: linear-gradient(to bottom, #3949ab, #283593);
            color: white;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
            background: linear-gradient(to bottom, #4252c8, #3244b5);
        }
        
        button:active {
            transform: translateY(1px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .warning {
            color: #ff5252;
            font-weight: bold;
            margin: 10px 0;
            text-align: center;
            min-height: 24px;
            font-size: 1.1rem;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
        }
        
        .instructions {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-top: 10px;
            width: 95%;
            max-width: 800px;
            text-align: center;
        }
        
        .ai-hint {
            background: linear-gradient(135deg, #ff8a00, #e52e71);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            width: 95%;
            max-width: 800px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .element-label {
            position: absolute;
            background: rgba(0, 0, 0, 0.6);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            pointer-events: none;
            z-index: 25;
        }
        
        @media (max-width: 600px) {
            h1 {
                font-size: 1.8rem;
            }
            
            .lab-container {
                height: 350px;
            }
            
            button {
                padding: 10px 15px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ”® å…‰å½±é­”æ³•å®éªŒå®¤</h1>
        <p class="subtitle">æ‹–åŠ¨å…‰æºã€çƒä½“æˆ–æŠ•å½±å±ï¼Œè§‚å¯Ÿå½±å­çš„ç¥å¥‡å˜åŒ–ï¼</p>
    </div>
    
    <div class="lab-container" id="lab">
        <div class="light-source" id="light">
            <div class="flashlight-body"></div>
            <div class="flashlight-head">
                <div class="flashlight-lens"></div>
            </div>
            <div class="light-beam" id="lightBeam"></div>
            <div class="element-label" style="bottom: -25px; left: 10px;">å…‰æº</div>
        </div>
        
        <div class="object" id="object">
            <div class="object-highlight"></div>
            <div class="element-label" style="bottom: -25px; left: 15px;">çƒä½“</div>
        </div>
        
        <div class="screen" id="screen">
            <div class="element-label" style="top: -30px; left: -10px;">æŠ•å½±å±</div>
        </div>
        
        <!-- å½±å­å°†ç”±JavaScriptåŠ¨æ€åˆ›å»º -->
    </div>
    
    <div class="warning" id="warning"></div>
    
    <div class="controls">
        <button onclick="resetLab()">
            <span>ğŸ”„</span> é‡ç½®å®éªŒ
        </button>
        <button onclick="toggleElement('light')">
            <span>ğŸ’¡</span> æ˜¾ç¤º/éšè—å…‰æº
        </button>
        <button onclick="toggleElement('object')">
            <span>ğŸ”´</span> æ˜¾ç¤º/éšè—çƒä½“
        </button>
        <button onclick="toggleElement('screen')">
            <span>ğŸ“º</span> æ˜¾ç¤º/éšè—æŠ•å½±å±
        </button>
    </div>
    
    <div class="instructions">
        <p>ğŸ’¡ <strong>æ“ä½œæŒ‡å—ï¼š</strong> æ‹–åŠ¨å…‰æºã€çƒä½“æˆ–æŠ•å½±å±æ¥æ”¹å˜å®ƒä»¬çš„ä½ç½®ï¼Œè§‚å¯Ÿå½±å­çš„å˜åŒ–ï¼</p>
    </div>
    
    <div class="ai-hint">
        <p>ğŸ§™â€â™‚ï¸ <strong>AIé­”æ³•æç¤ºï¼š</strong> ç¼ºå°‘å…‰æºã€çƒä½“æˆ–æŠ•å½±å±ä¸­çš„ä»»ä½•ä¸€ä¸ªï¼Œå½±å­å¬å”¤éƒ½ä¼šå¤±è´¥å“¦ï¼</p>
    </div>

    <script>
        // è·å–å…ƒç´ 
        const lab = document.getElementById('lab');
        const light = document.getElementById('light');
        const object = document.getElementById('object');
        const screen = document.getElementById('screen');
        const warning = document.getElementById('warning');
        const lightBeam = document.getElementById('lightBeam');
        
        let shadow = null;
        let draggedElement = null;
        let offsetX, offsetY;
        
        // åˆå§‹åŒ–å½±å­
        function initShadow() {
            shadow = document.createElement('div');
            shadow.className = 'shadow';
            lab.appendChild(shadow);
            updateShadow();
        }
        
        // æ›´æ–°å½±å­ä½ç½®å’Œå¤§å°
        function updateShadow() {
            // æ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨ä¸”å¯è§
            const lightVisible = light.style.display !== 'none';
            const objectVisible = object.style.display !== 'none';
            const screenVisible = screen.style.display !== 'none';
            
            if (!lightVisible || !objectVisible || !screenVisible) {
                warning.textContent = 'é­”æ³•å¤±è´¥ï¼ç¼ºå°‘å®éªŒå…ƒç´ ï¼';
                if (shadow) shadow.style.display = 'none';
                lightBeam.style.display = 'none';
                return;
            }
            
            warning.textContent = '';
            if (shadow) shadow.style.display = 'block';
            lightBeam.style.display = 'block';
            
            // è®¡ç®—å½±å­çš„ä½ç½®å’Œå¤§å°ï¼ˆåŸºäºå…‰å­¦åŸç†ï¼‰
            const lightRect = light.getBoundingClientRect();
            const objectRect = object.getBoundingClientRect();
            const screenRect = screen.getBoundingClientRect();
            const labRect = lab.getBoundingClientRect();
            
            const lightX = lightRect.left + lightRect.width / 2 - labRect.left;
            const objectX = objectRect.left + objectRect.width / 2 - labRect.left;
            const screenX = screenRect.left - labRect.left;
            
            const lightY = lightRect.top + lightRect.height / 2 - labRect.top;
            const objectY = objectRect.top + objectRect.height / 2 - labRect.top;
            const screenY = screenRect.top + screenRect.height / 2 - labRect.top;
            
            // è®¡ç®—å…‰çº¿æ–¹å‘å‘é‡
            const dirX = objectX - lightX;
            const dirY = objectY - lightY;
            
            // è®¡ç®—å…‰çº¿ä¸å±å¹•çš„äº¤ç‚¹
            const t = (screenX - objectX) / dirX;
            const intersectY = objectY + dirY * t;
            
            // è®¡ç®—å½±å­å¤§å°ï¼ˆè·ç¦»è¶Šè¿œï¼Œå½±å­è¶Šå¤§ï¼‰
            const distanceToScreen = screenX - objectX;
            const distanceLightToObject = objectX - lightX;
            
            if (distanceLightToObject <= 0 || t < 0) {
                if (shadow) shadow.style.display = 'none';
                return;
            }
            
            const scale = 1 + Math.abs(distanceToScreen / distanceLightToObject);
            const shadowSize = objectRect.width * scale;
            
            // è®¡ç®—å½±å­ä½ç½®ï¼ˆåœ¨å±å¹•ä¸Šï¼‰
            const shadowLeft = screenX;
            const shadowTop = intersectY - shadowSize / 2;
            
            // åº”ç”¨å½±å­æ ·å¼
            if (shadow) {
                shadow.style.width = shadowSize + 'px';
                shadow.style.height = shadowSize + 'px';
                shadow.style.left = shadowLeft + 'px';
                shadow.style.top = shadowTop + 'px';
                shadow.style.borderRadius = '50%';
            }
            
            // æ›´æ–°å…‰çº¿æŸçš„æ–¹å‘å’Œå¤§å°
            updateLightBeam(lightX, lightY, objectX, objectY);
        }
        
        // æ›´æ–°å…‰çº¿æŸ
        function updateLightBeam(lightX, lightY, objectX, objectY) {
            // è®¡ç®—å…‰çº¿æŸçš„è§’åº¦
            const deltaX = objectX - lightX;
            const deltaY = objectY - lightY;
            const angle = Math.atan2(deltaY, deltaX) * (180 / Math.PI);
            
            // è®¡ç®—å…‰çº¿æŸçš„é•¿åº¦
            const beamLength = Math.sqrt(deltaX * deltaX + deltaY * deltaY) * 1.5;
            
            // æ›´æ–°å…‰çº¿æŸæ ·å¼
            lightBeam.style.width = beamLength + 'px';
            lightBeam.style.transform = `rotate(${angle}deg)`;
            lightBeam.style.transformOrigin = '0% 50%';
        }
        
        // é‡ç½®å®éªŒå®¤
        function resetLab() {
            light.style.left = '80px';
            light.style.top = '180px';
            light.style.display = 'block';
            
            object.style.left = '300px';
            object.style.top = '165px';
            object.style.display = 'block';
            
            screen.style.right = '80px';
            screen.style.top = '75px';
            screen.style.display = 'block';
            
            updateShadow();
        }
        
        // æ˜¾ç¤º/éšè—å…ƒç´ 
        function toggleElement(elementId) {
            const element = document.getElementById(elementId);
            if (element.style.display === 'none') {
                element.style.display = 'block';
            } else {
                element.style.display = 'none';
            }
            updateShadow();
        }
        
        // æ‹–æ‹½åŠŸèƒ½
        function setupDrag(element) {
            element.addEventListener('mousedown', startDrag);
            element.addEventListener('touchstart', startDragTouch);
        }
        
        function startDrag(e) {
            e.preventDefault();
            draggedElement = this;
            
            const rect = draggedElement.getBoundingClientRect();
            offsetX = e.clientX - rect.left;
            offsetY = e.clientY - rect.top;
            
            document.addEventListener('mousemove', onDrag);
            document.addEventListener('mouseup', stopDrag);
        }
        
        function startDragTouch(e) {
            e.preventDefault();
            draggedElement = this;
            
            const touch = e.touches[0];
            const rect = draggedElement.getBoundingClientRect();
            offsetX = touch.clientX - rect.left;
            offsetY = touch.clientY - rect.top;
            
            document.addEventListener('touchmove', onDragTouch);
            document.addEventListener('touchend', stopDrag);
        }
        
        function onDrag(e) {
            if (!draggedElement) return;
            
            const labRect = lab.getBoundingClientRect();
            const x = e.clientX - labRect.left - offsetX;
            const y = e.clientY - labRect.top - offsetY;
            
            // é™åˆ¶åœ¨å®éªŒå®¤å†…
            const maxX = labRect.width - draggedElement.offsetWidth;
            const maxY = labRect.height - draggedElement.offsetHeight;
            
            if (draggedElement === screen) {
                // å¯¹äºæŠ•å½±å±ï¼Œæˆ‘ä»¬ä½¿ç”¨rightå’Œtopå®šä½
                const right = labRect.width - (x + draggedElement.offsetWidth);
                draggedElement.style.right = Math.max(10, Math.min(right, labRect.width - 10)) + 'px';
                draggedElement.style.top = Math.max(10, Math.min(y, maxY)) + 'px';
            } else {
                draggedElement.style.left = Math.max(10, Math.min(x, maxX)) + 'px';
                draggedElement.style.top = Math.max(10, Math.min(y, maxY)) + 'px';
            }
            
            updateShadow();
        }
        
        function onDragTouch(e) {
            if (!draggedElement) return;
            
            const touch = e.touches[0];
            const labRect = lab.getBoundingClientRect();
            const x = touch.clientX - labRect.left - offsetX;
            const y = touch.clientY - labRect.top - offsetY;
            
            // é™åˆ¶åœ¨å®éªŒå®¤å†…
            const maxX = labRect.width - draggedElement.offsetWidth;
            const maxY = labRect.height - draggedElement.offsetHeight;
            
            if (draggedElement === screen) {
                // å¯¹äºæŠ•å½±å±ï¼Œæˆ‘ä»¬ä½¿ç”¨rightå’Œtopå®šä½
                const right = labRect.width - (x + draggedElement.offsetWidth);
                draggedElement.style.right = Math.max(10, Math.min(right, labRect.width - 10)) + 'px';
                draggedElement.style.top = Math.max(10, Math.min(y, maxY)) + 'px';
            } else {
                draggedElement.style.left = Math.max(10, Math.min(x, maxX)) + 'px';
                draggedElement.style.top = Math.max(10, Math.min(y, maxY)) + 'px';
            }
            
            updateShadow();
        }
        
        function stopDrag() {
            draggedElement = null;
            document.removeEventListener('mousemove', onDrag);
            document.removeEventListener('touchmove', onDragTouch);
            document.removeEventListener('mouseup', stopDrag);
            document.removeEventListener('touchend', stopDrag);
        }
        
        // åˆå§‹åŒ–
        window.addEventListener('load', function() {
            initShadow();
            setupDrag(light);
            setupDrag(object);
            setupDrag(screen);
            
            // å“åº”çª—å£å¤§å°å˜åŒ–
            window.addEventListener('resize', updateShadow);
        });
    </script>
</body>
</html>